<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional To-Do App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/your-fontawesome-key.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body class="bg-gray-100 dark:bg-gray-900">
    <!-- Login Page -->
    <div id="login-page" class="flex items-center justify-center min-h-screen">
        <div class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg w-96">
            <h2 class="text-2xl font-bold text-center mb-6 text-gray-800 dark:text-white">Login</h2>
            <form id="login-form">
                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2" for="email">Email</label>
                    <input type="email" id="email" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:border-gray-600" value="test@example.com">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2" for="password">Password</label>
                    <input type="password" id="password" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:border-gray-600" value="123456">
                </div>
                <button type="submit" class="w-full bg-primary text-white py-2 rounded-lg hover:bg-opacity-90 transition duration-200">Login</button>
                <p class="mt-4 text-center text-gray-600 dark:text-gray-400">
                    Don't have an account? <span id="register-link" class="text-blue-500 cursor-pointer">Register</span>
                </p>
            </form>
        </div>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboard-page" class="hidden container mx-auto p-4">
        <!-- Header -->
        <header class="mb-6">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-bold text-gray-800 dark:text-white">Task Manager</h1>
                <div class="flex items-center space-x-4">
                    <button id="dark-mode-toggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">
                        <i class="fas fa-moon text-gray-600 dark:text-yellow-500"></i>
                    </button>
                    <div class="relative">
                        <button id="profile-btn" class="flex items-center space-x-2">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Avatar" class="w-8 h-8 rounded-full">
                            <span class="text-gray-800 dark:text-white">John Doe</span>
                        </button>
                        <div id="profile-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg">
                            <div class="p-4">
                                <p class="text-sm text-gray-600 dark:text-gray-400">Logged in as</p>
                                <p class="font-bold text-gray-800 dark:text-white">test@example.com</p>
                            </div>
                            <div class="border-t border-gray-200 dark:border-gray-700">
                                <button class="w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700">Profile</button>
                                <button id="logout-btn" class="w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700">Logout</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Tasks Section -->
            <div class="col-span-2">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white">Tasks</h3>
                        <button id="add-task-btn" class="bg-primary text-white px-4 py-2 rounded-lg">Add Task</button>
                    </div>
                    <div id="tasks-container"></div>
                </div>
            </div>

            <!-- Insights Section -->
            <div class="col-span-1">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Insights</h3>
                    <div class="space-y-4">
                        <div class="p-4 bg-gray-100 dark:bg-gray-700 rounded-lg">
                            <p class="text-sm text-gray-500 dark:text-gray-400">Total Tasks</p>
                            <p id="total-tasks" class="text-2xl font-bold text-gray-800 dark:text-white">0</p>
                        </div>
                        <div class="p-4 bg-gray-100 dark:bg-gray-700 rounded-lg">
                            <p class="text-sm text-gray-500 dark:text-gray-400">Completed</p>
                            <p id="completed-tasks" class="text-2xl font-bold text-green-500">0</p>
                        </div>
                        <div class="p-4 bg-gray-100 dark:bg-gray-700 rounded-lg">
                            <p class="text-sm text-gray-500 dark:text-gray-400">Pending</p>
                            <p id="pending-tasks" class="text-2xl font-bold text-yellow-500">0</p>
                        </div>
                        <canvas id="task-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Task Modal -->
    <div id="task-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md mx-auto mt-20">
            <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white">Add Task</h3>
            <form id="task-form">
                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">Title</label>
                    <input type="text" id="task-title" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:border-gray-600">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">Description</label>
                    <textarea id="task-description" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:border-gray-600"></textarea>
                </div>
                <div class="flex justify-end">
                    <button type="button" class="modal-close px-4 py-2 bg-gray-300 dark:bg-gray-700 rounded-lg mr-2">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-primary text-white rounded-lg">Save</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Dark Mode Toggle
        document.getElementById('dark-mode-toggle').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark')
            localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'))
        })

        // Initialize dark mode from localStorage
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark')
        }

        // Login Handling
        document.getElementById('login-form').addEventListener('submit', (e) => {
            e.preventDefault()
            const email = document.getElementById('email').value
            const password = document.getElementById('password').value

            if (email === 'test@example.com' && password === '123456') {
                document.getElementById('login-page').classList.add('hidden')
                document.getElementById('dashboard-page').classList.remove('hidden')
            } else {
                alert('Invalid credentials')
            }
        })

        // Registration Handling (simplified)
        document.getElementById('register-link').addEventListener('click', () => {
            // Implement registration logic here
        })

        // Task Management
        let tasks = JSON.parse(localStorage.getItem('tasks')) || []
        const renderTasks = () => {
            const container = document.getElementById('tasks-container')
            container.innerHTML = ''

            tasks.forEach(task => {
                const taskDiv = document.createElement('div')
                taskDiv.className = 'p-4 mb-4 bg-gray-100 dark:bg-gray-700 rounded-lg'
                taskDiv.innerHTML = `
                    <h4 class="font-semibold text-gray-800 dark:text-white">${task.title}</h4>
                    <p class="text-sm text-gray-600 dark:text-gray-400">${task.description}</p>
                `
                container.appendChild(taskDiv)
            })
        }

        // Add Task
        document.getElementById('task-form').addEventListener('submit', (e) => {
            e.preventDefault()
            const title = document.getElementById('task-title').value
            const description = document.getElementById('task-description').value

            tasks.push({ id: Date.now(), title, description, completed: false })
            localStorage.setItem('tasks', JSON.stringify(tasks))
            renderTasks()
            document.getElementById('task-modal').classList.add('hidden')
        })

        // Initial render
        renderTasks()

        // Export Functionality
        document.getElementById('export-tasks').addEventListener('click', () => {
            const format = document.getElementById('export-format').value
            let content

            switch(format) {
                case 'json':
                    content = JSON.stringify(tasks, null, 2)
                    downloadFile('tasks.json', 'application/json', content)
                    break
                case 'csv':
                    content = convertToCSV(tasks)
                    downloadFile('tasks.csv', 'text/csv', content)
                    break
                // Add other formats
            }
        })

        function downloadFile(filename, mimeType, content) {
            const blob = new Blob([content], { type: mimeType })
            const url = URL.createObjectURL(blob)
            const link = document.createElement('a')
            link.href = url
            link.download = filename
            link.click()
            URL.revokeObjectURL(url)
        }

        // Insights Initialization
        function updateInsights() {
            const total = tasks.length
            const completed = tasks.filter(t => t.completed).length
            const pending = total - completed

            document.getElementById('total-tasks').textContent = total
            document.getElementById('completed-tasks').textContent = completed
            document.getElementById('pending-tasks').textContent = pending

            // Update chart
            if (window.taskChart) {
                window.taskChart.data.labels = ['Completed', 'Pending']
                window.taskChart.data.datasets[0].data = [completed, pending]
                window.taskChart.update()
            } else {
                const ctx = document.getElementById('task-chart').getContext('2d')
                window.taskChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Completed', 'Pending'],
                        datasets: [{
                            data: [completed, pending],
                            backgroundColor: ['#4CAF50', '#FFA726']
                        }]
                    }
                })
            }
        }

        // Initial insights update
        updateInsights()
    </script>
</body>
</html>
